!function(){"use strict";angular.module("angular-loading-bar",["cfp.loadingBarInterceptor"]),angular.module("cfp.loadingBarInterceptor",["cfp.loadingBar"]).config(["$httpProvider",function(e){var t=["$q","$cacheFactory","$timeout","$rootScope","$log","cfpLoadingBar",function(t,n,a,r,i,c){function o(){a.cancel(d),c.complete(),u=0,s=0}function l(t){var a,r=n.get("$http"),i=e.defaults;!t.cache&&!i.cache||t.cache===!1||"GET"!==t.method&&"JSONP"!==t.method||(a=angular.isObject(t.cache)?t.cache:angular.isObject(i.cache)?i.cache:r);var c=void 0!==a?void 0!==a.get(t.url):!1;return void 0!==t.cached&&c!==t.cached?t.cached:(t.cached=c,c)}var d,s=0,u=0,h=c.latencyThreshold;return{request:function(e){return e.ignoreLoadingBar||l(e)||-1!=e.url.indexOf(".html")||(r.$broadcast("cfpLoadingBar:loading",{url:e.url}),0===s&&(d=a(function(){c.start()},h)),s++,c.set(u/s)),e},response:function(e){return e&&e.config?(e.config.ignoreLoadingBar||l(e.config)||(u++,r.$broadcast("cfpLoadingBar:loaded",{url:e.config.url,result:e}),s>u?c.set(u/s):o()),e):e},responseError:function(e){return e&&e.config?(e.config.ignoreLoadingBar||l(e.config)||(u++,r.$broadcast("cfpLoadingBar:loaded",{url:e.config.url,result:e}),s>u?c.set(u/s):o()),t.reject(e)):t.reject(e)}}}];e.interceptors.push(t)}]),angular.module("cfp.loadingBar",[]).provider("cfpLoadingBar",function(){this.autoIncrement=!0,this.includeSpinner=!0,this.includeBar=!1,this.latencyThreshold=100,this.startSize=.02,this.parentSelector="body",this.spinnerTemplate='<div id="loading-bar-spinner" style="top: 50%; left: 50%;"><div class="spinner-icon"></div></div>',this.loadingBarTemplate='<div id="loading-bar"><div class="bar"><div class="peg"></div></div></div>',this.$get=["$injector","$document","$timeout","$rootScope",function(e,t,n,a){function r(){s||(s=e.get("$animate"));var r=t.find(g).eq(0);n.cancel(h),v||(a.$broadcast("cfpLoadingBar:started"),v=!0,b&&s.enter(f,r,angular.element(r[0].lastChild)),S&&s.enter(m,r,angular.element(r[0].lastChild)),i(L))}function i(e){if(v){var t=100*e+"%";p.css("width",t),$=e,B&&(n.cancel(u),u=n(function(){c()},250))}}function c(){if(o()<1){var e=0,t=o();e=t>=0&&.25>t?(3*Math.random()+3)/100:t>=.25&&.65>t?3*Math.random()/100:t>=.65&&.9>t?2*Math.random()/100:t>=.9&&.99>t?.005:0;var n=o()+e;i(n)}}function o(){return $}function l(){$=0,v=!1}function d(){s||(s=e.get("$animate")),a.$broadcast("cfpLoadingBar:completed"),i(1),n.cancel(h),h=n(function(){var e=s.leave(f,l);e&&e.then&&e.then(l),s.leave(m)},500)}var s,u,h,g=this.parentSelector,f=angular.element(this.loadingBarTemplate),p=f.find("div").eq(0),m=angular.element(this.spinnerTemplate),v=!1,$=0,B=this.autoIncrement,S=this.includeSpinner,b=this.includeBar,L=this.startSize;return{start:r,set:i,status:o,inc:c,complete:d,autoIncrement:this.autoIncrement,includeSpinner:this.includeSpinner,latencyThreshold:this.latencyThreshold,parentSelector:this.parentSelector,startSize:this.startSize}}]})}();